<?xml version="1.0" encoding="utf-8"?>

<TranscendenceModule>

<!-- RPG USE ITEM ==============================================================

	This screen allows the player to use an item on another item or device.

	gData uses the following fields:

		useItem:	The item being used. If not specifed we check gItem instead

-->

	<DockScreen UNID="&dsRPGUseItem;"
			inherit=			"&dsDockScreenBase;"
			nestedScreen=		"true"
			name=				"=(itmGetName (or (@ gData 'useItem) gItem) 'capitalize)"
			>

		<OnScreenInit>
			(scrSetData gScreen 'useItem (or (@ gData 'useItem) gItem))
		</OnScreenInit>

		<Panes>
			<Default>
				<OnPaneInit>
					(block (
						(useItem (scrGetData gScreen 'useItem))
						(theShip gPlayerShip)

						(screenSet (list
							{
								screen: &dsRPGUseItem;
								label: (scrTranslate gScreen 'screenSetUseItem)
								mainScreen: True
								}
							{
								screen: &dsRPGUseItemOnArmor;
								label: (scrTranslate gScreen 'screenSetUseItemOnArmor)
								data: { useItem: useItem }
								}
							{
								screen: &dsRPGUseItemOnDevice;
								label: (scrTranslate gScreen 'screenSetUseItemOnDevice)
								data: { useItem: useItem }
								}
							{
								screen: &dsRPGUseItemOnCargo;
								label: (scrTranslate gScreen 'screenSetUseItemOnCargo)
								data: { useItem: useItem }
								}
							))
						)

						(scrSetControlValue gScreen 'useItem {
							source: theShip
							item: useItem
							})

						(scrSetDescTranslate gScreen 'descUseItem)

						;   Define the screen set
						
						(scrSetData gScreen 'screenSet screenSet)
						(rpgInitScreenSet screenSet)
						)
				</OnPaneInit>

				<Controls>
					<ItemDisplay id="useItem"/>
				</Controls>

				<Actions>
					<Action id="actionArmor">
						(scrShowScreen gScreen &dsRPGUseItemOnArmor; {
							useItem: (scrGetData gScreen 'useItem)
							screenSet: (scrGetData gScreen 'screenSet)
							})
					</Action>
					<Action id="actionDevice">
						(scrShowScreen gScreen &dsRPGUseItemOnDevice; {
							useItem: (scrGetData gScreen 'useItem)
							screenSet: (scrGetData gScreen 'screenSet)
							})
					</Action>
					<Action id="actionCargo">
						(scrShowScreen gScreen &dsRPGUseItemOnCargo; {
							useItem: (scrGetData gScreen 'useItem)
							screenSet: (scrGetData gScreen 'screenSet)
							})
					</Action>
				</Actions>
			</Default>
		</Panes>
		
		<Language>
			<Text id="actionArmor">Use on [A]rmor</Text>
			<Text id="actionDevice">Use on D[e]vice</Text>
			<Text id="actionCargo">Use on [C]argo item</Text>

			<Text id="descUseItem">How do you want to use this item?</Text>

			<Text id="screenSetUseItem">Main page</Text>
			<Text id="screenSetUseItemOnArmor">Armor page</Text>
			<Text id="screenSetUseItemOnDevice">Device page</Text>
			<Text id="screenSetUseItemOnCargo">Cargo page</Text>
		</Language>
	</DockScreen>

</TranscendenceModule>
